<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BetterBattery — Your MacBook Battery Is Dying on Your Desk</title>
  <meta name="description" content="Double your MacBook's battery lifespan with a free 10-minute setup. No app needed. Works on any Apple Silicon Mac.">

  <!-- Open Graph (iMessage, Slack, Discord, Facebook, LinkedIn) -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://betterbattery.org/">
  <meta property="og:title" content="Double your MacBook's battery lifespan">
  <meta property="og:description" content="Free 10-minute setup. No app needed. Works on any Apple Silicon Mac.">
  <meta property="og:image" content="https://betterbattery.org/og-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:site_name" content="BetterBattery">

  <!-- Twitter / X -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://betterbattery.org/og-image.png">
  <meta name="twitter:title" content="Double your MacBook's battery lifespan">
  <meta name="twitter:description" content="Free 10-minute setup. No app needed. Works on any Apple Silicon Mac.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,600;9..144,700&family=JetBrains+Mono&family=Source+Sans+3:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --text: #1e1e1e;
      --text-muted: #5a5a6e;
      --accent: #c17a1a;
      --accent-light: #fef3e2;
      --bg: #faf8f5;
      --dark-bg: #1e1e1e;
      --dark-text: #f0ede8;
      --dark-muted: #a8a4a0;
      --code-bg: #1a1a2e;
      --code-text: #cdd6f4;
      --code-border: #313244;
      --border: #e5e0d8;
      --green: #3a8a5c;
      --radius: 8px;
      --max-width: 720px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }

    body {
      font-family: 'Source Sans 3', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      color: var(--text);
      background: var(--bg);
      line-height: 1.7;
      font-size: 17px;
      -webkit-font-smoothing: antialiased;
    }

    /* ── Typography ── */
    h1, h2, h3 {
      font-family: 'Fraunces', Georgia, serif;
      font-weight: 700;
      letter-spacing: -0.01em;
    }

    h2 { font-size: 1.6rem; margin-bottom: 20px; }
    h3 { font-size: 1.15rem; margin-top: 28px; margin-bottom: 10px; }

    p { margin-bottom: 16px; }
    p:last-child { margin-bottom: 0; }

    a {
      color: var(--accent);
      text-decoration: underline;
      text-decoration-thickness: 1px;
      text-underline-offset: 2px;
    }
    a:hover { text-decoration-thickness: 2px; }

    strong { font-weight: 600; }

    code, pre code {
      font-family: 'JetBrains Mono', 'SF Mono', 'Menlo', monospace;
    }

    code {
      font-size: 0.88em;
      background: rgba(0,0,0,0.05);
      border: 1px solid var(--border);
      padding: 2px 6px;
      border-radius: 4px;
    }

    pre code {
      background: none;
      border: none;
      padding: 0;
      font-size: inherit;
    }

    /* ── Layout ── */
    .container {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 24px;
    }

    .container-wide {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 24px;
    }

    section { padding: 128px 0; }
    section + section { margin-top: -128px; }
    .environment, .setup, .closing { margin-top: 0; }
    .container > :last-child { margin-bottom: 0; }

    /* ── Site Header ── */
    .header-wrap {
      z-index: 100;
      background: var(--bg);
      border-bottom: 1px solid var(--border);
    }

    .header-spacer {
      display: none;
    }

    .header-wrap.header-sticky {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      transform: translateY(-100%);
      transition: transform 0.25s ease;
    }

    .header-wrap.header-sticky + .header-spacer {
      display: block;
    }

    .header-wrap.header-sticky.header-visible {
      transform: translateY(0);
    }

    .site-header {
      padding: 14px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: 900px;
      margin: 0 auto;
      position: relative;
    }

    .site-title {
      font-family: 'Fraunces', Georgia, serif;
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 0;
      color: var(--text);
      text-decoration: none;
      cursor: pointer;
    }

    .site-title:hover {
      text-decoration: none;
      opacity: 0.7;
    }

    .header-badge {
      font-size: 0.82rem;
      color: #2d6a4f;
      background: #d8f3dc;
      padding: 4px 14px;
      border-radius: 20px;
      letter-spacing: 0.01em;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

    .header-cta {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
      font-size: 0.85rem;
      font-weight: 500;
      padding: 7px 16px;
      background: var(--text);
      color: var(--bg);
      border-radius: 6px;
      text-decoration: none;
      transition: opacity 0.15s;
      letter-spacing: -0.01em;
    }

    .header-cta:hover {
      opacity: 0.85;
      text-decoration: none;
    }

    /* ── Closing Impact ── */
    .closing {
      text-align: center;
      border-top: 1px solid var(--border);
    }

    .closing h2 {
      font-size: clamp(1.8rem, 4vw, 2.4rem);
      line-height: 1.2;
    }

    .closing .subtitle {
      font-size: 1.05rem;
      color: var(--text-muted);
      max-width: 580px;
      margin: 0 auto 64px;
      line-height: 1.65;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 24px;
      max-width: 800px;
      margin: 0 auto 64px;
    }

    .stat {
      text-align: center;
    }

    .stat-number {
      font-family: 'Fraunces', Georgia, serif;
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent);
      display: block;
      line-height: 1.2;
    }

    .stat-label {
      font-size: 0.85rem;
      color: var(--text-muted);
      line-height: 1.4;
      margin-top: 6px;
    }

    .cta-btn {
      display: inline-block;
      background: var(--accent);
      color: #fff;
      font-family: 'Source Sans 3', sans-serif;
      font-size: 1.05rem;
      font-weight: 600;
      padding: 14px 32px;
      border-radius: 8px;
      text-decoration: none;
      transition: background 0.2s, transform 0.1s;
    }
    .cta-btn:hover {
      background: #a8660f;
      text-decoration: none;
      transform: translateY(-1px);
    }

    /* ── How It Works ── */
    .modes-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin: 28px 0;
    }

    .mode-card {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 28px 24px;
      text-align: center;
    }

    .mode-icon {
      font-size: 2.4rem;
      margin-bottom: 8px;
    }

    .mode-title {
      font-family: 'Fraunces', Georgia, serif;
      font-size: 1.15rem;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .mode-detail {
      font-size: 0.92rem;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    .mode-led {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.85rem;
      margin-top: 10px;
      padding: 4px 12px;
      border-radius: 20px;
    }

    .led-green {
      background: #e8f5ec;
      color: var(--green);
    }

    .led-amber {
      background: var(--accent-light);
      color: var(--accent);
    }

    .led-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      display: inline-block;
    }

    .led-green .led-dot { background: var(--green); }
    .led-amber .led-dot { background: var(--accent); }

    .reassurance {
      text-align: center;
      color: var(--text-muted);
      font-size: 0.95rem;
      font-style: italic;
    }

    .tooltip-wrap {
      position: relative;
      display: inline;
    }

    .tooltip-trigger {
      text-decoration: underline;
      text-decoration-style: dotted;
      text-underline-offset: 3px;
      text-decoration-thickness: 1.5px;
      cursor: help;
      color: inherit;
    }

    .tooltip-trigger:hover {
      color: var(--accent);
    }

    .tooltip-body {
      display: none;
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%);
      width: 260px;
      background: var(--dark-bg);
      color: var(--dark-text);
      font-size: 0.85rem;
      line-height: 1.5;
      padding: 14px 16px;
      border-radius: 8px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.15);
      z-index: 10;
      text-align: left;
      font-style: normal;
    }

    .tooltip-body::before {
      content: "";
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      height: 14px;
    }

    .tooltip-body::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: var(--dark-bg);
    }

    .tooltip-wrap:hover .tooltip-body {
      display: block;
    }

    .tooltip-body a {
      color: var(--accent);
      font-size: 0.82rem;
    }

    /* ── Science Section ── */
    .science-list {
      list-style: none;
      padding: 0;
    }

    .science-list li {
      position: relative;
      padding-left: 28px;
      margin-bottom: 14px;
      line-height: 1.6;
    }

    .science-list li::before {
      content: "";
      position: absolute;
      left: 0;
      top: 10px;
      width: 10px;
      height: 10px;
      background: var(--accent);
      border-radius: 50%;
    }

    /* ── Details/Accordion ── */
    details {
      margin: 48px 0;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
    }

    details summary {
      padding: 14px 18px;
      font-weight: 600;
      cursor: pointer;
      list-style: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
      user-select: none;
    }

    details summary::-webkit-details-marker { display: none; }

    details summary::after {
      content: "+";
      font-size: 1.3rem;
      font-weight: 400;
      color: var(--text-muted);
      transition: transform 0.2s;
      flex-shrink: 0;
      margin-left: 12px;
    }

    details[open] summary::after {
      content: "\2212";
    }

    details .details-body {
      padding: 0 18px 18px;
      border-top: 1px solid var(--border);
    }

    details .details-body p:first-child { margin-top: 14px; }

    /* ── Environmental (forest green) ── */
    .environment {
      background: #1a3a2a;
      color: #e8f0eb;
    }

    .environment h2 { color: #e8f0eb; }

    .environment .env-intro {
      color: #a8c5b4;
      font-size: 1.05rem;
    }

    .environment .stat-number { color: #6ecf8e; }
    .environment .stat-label { color: #a8c5b4; }

    .environment details {
      border-color: #2d5a40;
      background: rgba(255,255,255,0.04);
    }

    .environment details summary { color: #e8f0eb; }
    .environment details summary::after { color: #a8c5b4; }
    .environment details .details-body { border-top-color: #2d5a40; color: #a8c5b4; }
    .environment details .details-body p { color: #a8c5b4; }
    .environment details .details-body strong { color: #e8f0eb; }

    .env-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 24px;
      margin: 48px 0;
    }

    .env-empowerment {
      text-align: center;
      color: #a8c5b4;
      font-size: 0.95rem;
      font-style: italic;
      margin-top: 32px;
    }

    .env-empowerment strong {
      color: #6ecf8e;
      font-style: normal;
    }

    /* ── Impact Calculator ── */
    .calculator {
      background: rgba(255,255,255,0.06);
      border: 1px solid #2d5a40;
      border-radius: 12px;
      padding: 28px;
      margin-bottom: 32px;
    }

    .calculator h3 {
      font-family: 'Fraunces', Georgia, serif;
      color: #e8f0eb;
      margin-top: 0;
      margin-bottom: 16px;
    }

    .calc-label {
      color: #a8c5b4;
      font-size: 0.95rem;
      margin-bottom: 12px;
    }

    .calc-slider-row {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 24px;
    }

    .calc-slider-row input[type="range"] {
      flex: 1;
      -webkit-appearance: none;
      height: 6px;
      border-radius: 3px;
      background: #2d5a40;
      outline: none;
    }

    .calc-slider-row input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: #6ecf8e;
      cursor: pointer;
      border: 2px solid #1a3a2a;
    }

    .calc-slider-row input[type="range"]::-moz-range-thumb {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: #6ecf8e;
      cursor: pointer;
      border: 2px solid #1a3a2a;
    }

    .calc-pct {
      font-family: 'Fraunces', Georgia, serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: #6ecf8e;
      min-width: 60px;
      text-align: right;
    }

    .calc-results {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }

    .calc-result {
      text-align: center;
      padding: 16px 8px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
    }

    .calc-result-number {
      font-family: 'Fraunces', Georgia, serif;
      font-size: 1.4rem;
      font-weight: 700;
      color: #6ecf8e;
      display: block;
    }

    .calc-result-label {
      font-size: 0.8rem;
      color: #a8c5b4;
      margin-top: 4px;
      display: block;
      line-height: 1.3;
    }

    .calc-footnote {
      font-size: 0.78rem;
      color: #6a9a7e;
      margin-top: 16px;
      text-align: center;
      max-width: 380px;
      margin-left: auto;
      margin-right: auto;
    }

    .calc-footnote a {
      color: #6ecf8e;
      text-decoration-thickness: 1px;
    }

    .calc-timeframe {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 20px;
    }

    .calc-timeframe-label {
      font-size: 0.88rem;
      color: #a8c5b4;
    }

    .calc-time-pill {
      font-family: 'Source Sans 3', sans-serif;
      font-size: 0.85rem;
      font-weight: 600;
      padding: 6px 14px;
      background: rgba(255,255,255,0.06);
      border: 1px solid #2d5a40;
      border-radius: 20px;
      color: #a8c5b4;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s, color 0.15s;
    }

    .calc-time-pill:hover {
      border-color: #6ecf8e;
      color: #e8f0eb;
    }

    .calc-time-pill.selected {
      background: #6ecf8e;
      border-color: #6ecf8e;
      color: #1a3a2a;
    }

    /* ── Setup Section ── */
    .setup { border-top: 1px solid var(--border); }

    .setup-triage {
      margin-top: 64px;
    }

    .triage-step {
      margin-bottom: 0;
    }

    .triage-step.hidden,
    .triage-result.hidden {
      display: none;
    }

    .triage-question {
      font-family: 'Fraunces', Georgia, serif;
      font-size: 1.15rem;
      font-weight: 700;
      margin-bottom: 14px;
    }

    .triage-options {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    .triage-cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 24px;
    }

    .triage-card {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 28px 24px;
      display: flex;
      flex-direction: column;
      transition: border-color 0.15s;
    }

    .triage-card:hover {
      border-color: var(--accent);
    }

    .triage-card.selected {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent);
    }

    .triage-card.recommended {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent);
    }

    .triage-card.recommended .triage-card-cta {
      background: var(--accent);
      color: #fff;
    }

    .triage-card-badge {
      display: inline-block;
      font-size: 0.78rem;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #fff;
      background: var(--accent);
      padding: 3px 10px;
      border-radius: 12px;
      margin-bottom: 14px;
      align-self: flex-start;
    }

    .triage-card-title {
      font-family: 'Fraunces', Georgia, serif;
      font-size: 1.15rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .triage-card-desc {
      font-size: 0.92rem;
      color: var(--text-muted);
      line-height: 1.6;
      flex: 1;
    }

    .triage-card-cta {
      display: inline-block;
      margin-top: 20px;
      padding: 10px 24px;
      background: var(--text);
      color: var(--bg);
      font-family: 'Source Sans 3', sans-serif;
      font-size: 0.92rem;
      font-weight: 600;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: opacity 0.15s;
      text-align: center;
      align-self: flex-start;
    }

    .triage-card-cta:hover {
      opacity: 0.85;
    }

    .triage-card.selected .triage-card-cta {
      background: var(--accent);
      color: #fff;
    }

    .triage-cards.chosen {
      grid-template-columns: 1fr;
    }

    .triage-cards.chosen .triage-card:not(.selected) {
      display: none;
    }

    .triage-cards.chosen .triage-card.selected {
      cursor: default;
    }

    .triage-cards.chosen .triage-card.selected .triage-card-intro {
      display: none;
    }

    .triage-cards.chosen .triage-card.selected .triage-card-flow {
      display: block !important;
    }

    .triage-card-flow {
      display: none;
    }

    .triage-card-flow-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .triage-card-flow-header .triage-card-title {
      margin-bottom: 0;
    }

    .triage-card-change {
      font-family: 'Source Sans 3', sans-serif;
      font-size: 0.88rem;
      font-weight: 600;
      color: var(--accent);
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
      text-decoration: underline;
      text-underline-offset: 2px;
      text-decoration-thickness: 1px;
    }

    .triage-card-change:hover {
      text-decoration-thickness: 2px;
    }

    /* ── Stepper ── */
    .triage-stepper {
      display: flex;
      align-items: center;
      margin-bottom: 24px;
      gap: 0;
    }

    .triage-stepper-step {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 2px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Source Sans 3', sans-serif;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-muted);
      background: #fff;
      flex-shrink: 0;
      transition: all 0.2s;
    }

    .triage-stepper-step.active {
      border-color: var(--accent);
      background: var(--accent);
      color: #fff;
    }

    .triage-stepper-step.done {
      border-color: var(--green);
      background: var(--green);
      color: #fff;
    }

    .triage-stepper-line {
      flex: 1;
      height: 2px;
      background: var(--border);
      max-width: 60px;
      transition: background 0.2s;
    }

    .triage-stepper-line.done {
      background: var(--green);
    }

    .triage-substep {
      animation: triageFadeIn 0.3s ease;
    }

    .triage-substep.hidden {
      display: none;
    }

    .triage-pill {
      display: inline-block;
      padding: 8px 20px;
      border: 1px solid var(--border);
      border-radius: 24px;
      font-family: 'Source Sans 3', sans-serif;
      font-size: 0.92rem;
      font-weight: 600;
      cursor: pointer;
      background: #fff;
      color: var(--text);
      transition: all 0.15s;
      user-select: none;
    }

    .triage-pill:hover {
      border-color: var(--accent);
      background: var(--accent-light);
    }

    .triage-pill.selected {
      background: var(--accent);
      color: #fff;
      border-color: var(--accent);
    }

    .triage-result {
      animation: triageFadeIn 0.3s ease;
    }

    @keyframes triageFadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .triage-stop {
      border-left: 3px solid #c73e3e;
      background: #fef2f2;
      padding: 18px 22px;
      border-radius: 0 var(--radius) var(--radius) 0;
      margin: 14px 0;
    }

    .triage-stop p { font-size: 0.95rem; }

    .triage-stop.info {
      border-left-color: var(--accent);
      background: var(--accent-light);
    }

    .triage-help {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px 22px;
      margin: 14px 0;
    }

    .triage-help p { font-size: 0.92rem; color: var(--text-muted); }

    .triage-help .triage-options {
      margin-top: 14px;
    }

    .claude-explainer {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      margin: 14px 0;
    }

    .claude-explainer p {
      font-size: 0.95rem;
      color: var(--text-muted);
    }

    .claude-explainer .cta-link {
      display: inline-block;
      margin-top: 12px;
      font-weight: 600;
    }

    .prompt-intro {
      font-size: 0.95rem;
      color: var(--text-muted);
      margin-bottom: 16px;
    }

    .prompt-note {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-top: 14px;
      font-style: italic;
    }

    /* ── DIY Steps (Path B) ── */
    .diy-step {
      margin-bottom: 8px;
    }

    .diy-step details {
      margin: 0;
    }

    .diy-step details summary {
      font-size: 0.95rem;
    }

    /* ── Code Blocks ── */
    .code-block {
      position: relative;
      margin: 14px 0;
      border-radius: var(--radius);
      overflow: hidden;
      border: 1px solid var(--code-border);
    }

    .code-block pre {
      background: var(--code-bg);
      color: var(--code-text);
      padding: 16px 52px 16px 20px;
      overflow-x: auto;
      font-size: 13.5px;
      line-height: 1.6;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.12);
      color: #a6adc8;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 12px;
      font-family: 'Source Sans 3', sans-serif;
      transition: all 0.15s;
    }
    .copy-btn:hover { background: rgba(255,255,255,0.16); color: #cdd6f4; }
    .copy-btn.copied { background: rgba(58,138,92,0.3); color: #a6e3a1; border-color: rgba(58,138,92,0.4); }

    /* ── Callouts ── */
    .callout {
      border-left: 3px solid var(--accent);
      background: var(--accent-light);
      padding: 14px 18px;
      border-radius: 0 var(--radius) var(--radius) 0;
      margin: 14px 0;
      font-size: 0.92rem;
    }
    .callout p { margin-bottom: 0; }

    .callout.warning {
      border-left-color: #c73e3e;
      background: #fef2f2;
    }

    /* ── Nav Path ── */
    .nav-path {
      background: #fff;
      border: 1px solid var(--border);
      padding: 12px 18px;
      border-radius: var(--radius);
      font-size: 0.92rem;
      margin: 12px 0;
    }
    .nav-path span { color: var(--text-muted); }

    /* ── What to Expect ── */
    .expect-list {
      list-style: none;
      padding: 0;
    }

    .expect-list li {
      display: flex;
      gap: 14px;
      margin-bottom: 20px;
      align-items: flex-start;
    }

    .expect-list li:last-child { margin-bottom: 0; }

    .expect-icon {
      font-size: 1.4rem;
      flex-shrink: 0;
      width: 32px;
      text-align: center;
      line-height: 1.5;
    }

    .expect-text strong {
      display: block;
      margin-bottom: 2px;
    }

    .expect-text {
      font-size: 0.95rem;
      color: var(--text-muted);
    }

    /* ── App Teaser ── */
    .app-teaser {
      background: linear-gradient(135deg, #fef9f0, #fdf3e2);
      border: 1px solid #e8d5b8;
      border-radius: 12px;
      padding: 28px;
      margin-top: 24px;
      text-align: center;
    }

    .app-teaser-title {
      font-family: 'Fraunces', Georgia, serif;
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .app-teaser-desc {
      font-size: 0.92rem;
      color: var(--text-muted);
      margin-bottom: 20px;
    }

    .app-teaser-actions {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    .app-teaser-plus {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-family: 'Source Sans 3', sans-serif;
      font-size: 0.95rem;
      font-weight: 600;
      padding: 10px 20px;
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      transition: border-color 0.15s, background 0.15s;
      color: var(--text);
      line-height: 1;
    }

    .app-teaser-plus:hover {
      border-color: var(--accent);
    }

    .app-teaser-plus.voted {
      background: var(--accent-light);
      border-color: var(--accent);
      color: var(--accent);
    }

    .app-teaser-plus-count {
      font-variant-numeric: tabular-nums;
    }

    .app-teaser-form {
      display: flex;
      gap: 8px;
    }

    .app-teaser-form input[type="email"] {
      font-family: 'Source Sans 3', sans-serif;
      font-size: 0.92rem;
      padding: 10px 14px;
      border: 1px solid var(--border);
      border-radius: 8px;
      outline: none;
      width: 220px;
      transition: border-color 0.15s;
    }

    .app-teaser-form input[type="email"]:focus {
      border-color: var(--accent);
    }

    .app-teaser-form button {
      font-family: 'Source Sans 3', sans-serif;
      font-size: 0.92rem;
      font-weight: 600;
      padding: 10px 18px;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.15s;
      white-space: nowrap;
    }

    .app-teaser-form button:hover {
      background: #a8660f;
    }

    .app-teaser-thanks {
      font-size: 0.92rem;
      color: var(--green);
      font-weight: 600;
      display: none;
    }

    /* ── FAQ ── */
    .faq details { margin: 0 0 8px; }
    .faq details summary { font-size: 0.95rem; }
    .faq details .details-body { font-size: 0.93rem; color: var(--text-muted); }
    .faq details .details-body a { color: var(--accent); }

    /* ── Footer ── */
    footer {
      padding: 48px 0;
      border-top: 1px solid var(--border);
      text-align: center;
      color: var(--text-muted);
      font-size: 0.85rem;
    }
    footer p { margin-bottom: 8px; }
    footer a { color: var(--text-muted); }

    /* ── Focus States ── */
    a:focus-visible,
    button:focus-visible,
    summary:focus-visible,
    input:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* ── Responsive ── */
    @media (max-width: 768px) {
      .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 20px; }
      .modes-grid { gap: 12px; }
      .triage-options { gap: 8px; }
      .triage-pill { padding: 8px 16px; font-size: 0.88rem; }
      .calc-results { grid-template-columns: 1fr; }
    }

    @media (max-width: 600px) {
      body { font-size: 16px; }
      section { padding: 96px 0; }
      section + section { margin-top: -96px; }
      .site-header { flex-wrap: wrap; gap: 8px; padding: 14px 24px !important; }
      .header-badge { position: static; transform: none; width: 100%; text-align: center; order: -1; }
      h2 { font-size: 1.4rem; }
      .site-title { font-size: 1.4rem; }
      .mode-card { padding: 20px 14px; }
      .mode-detail { font-size: 0.85rem; }
      .stat-number { font-size: 1.6rem; }
      .code-block pre { font-size: 13px; padding: 14px 44px 14px 16px; }
      .calculator { padding: 20px; }
      .calc-results { grid-template-columns: 1fr; }
      .calc-result-number { font-size: 1.2rem; }
      .triage-cards { grid-template-columns: 1fr; gap: 16px; }
      .triage-card { padding: 20px 18px; }
      .app-teaser { padding: 22px 18px; }
      .app-teaser-actions { flex-direction: column; }
      .app-teaser-form { width: 100%; }
      .app-teaser-form input[type="email"] { flex: 1; width: auto; min-width: 0; }
    }
  </style>
</head>
<body>

  <main>

    <!-- ═══════════════════════════════════════════════════ -->
    <!-- HEADER                                             -->
    <!-- ═══════════════════════════════════════════════════ -->
    <div class="header-wrap" id="header-wrap">
      <header class="site-header">
        <a href="#" class="site-title" id="logo-link">BetterBattery</a>
        <span class="header-badge">Free &middot; 10 minutes &middot; Apple Silicon Macs</span>
        <a href="#setup" class="header-cta">Set it up</a>
      </header>
    </div>
    <div class="header-spacer" id="header-spacer"></div>


    <!-- ═══════════════════════════════════════════════════ -->
    <!-- SECTION 2: HOW IT WORKS                            -->
    <!-- ═══════════════════════════════════════════════════ -->
    <section>
      <div class="container">
        <h2>How BetterBattery Works</h2>
        <p>Your MacBook gets two power modes. Switch between them with a single tap.</p>

        <div class="modes-grid">
          <div class="mode-card">
            <div class="mode-icon">&#x26A1;</div>
            <div class="mode-title">Desk Mode</div>
            <p class="mode-detail">Battery holds at 70%</p>
            <p class="mode-detail">Essentially a <span class="tooltip-wrap"><span class="tooltip-trigger">PSU</span><span class="tooltip-body"><strong>Power Supply Unit</strong> &mdash; your Mac runs directly on wall power while the battery rests at a safe charge level, just like a desktop computer.<br><a href="https://en.wikipedia.org/wiki/Power_supply_unit_(computer)" target="_blank" rel="noopener">Learn more &rarr;</a></span></span> for your MacBook</p>
          </div>
          <div class="mode-card">
            <div class="mode-icon">&#x1F50B;</div>
            <div class="mode-title">Mobile Mode</div>
            <p class="mode-detail">One tap charges to 100%</p>
            <p class="mode-detail">Full battery for the road</p>
          </div>
        </div>

        <p class="reassurance">Your Mac works exactly the same in both modes. The BetterBattery method just changes how power is managed &mdash; your Mac may even run cooler on Desk Mode. <a href="#environment" style="color: #2d6a4f; text-decoration: underline; text-decoration-thickness: 1px; text-underline-offset: 2px;">Your ecosystem will thank you too &#x1F331;</a></p>
      </div>
    </section>


    <!-- ═══════════════════════════════════════════════════ -->
    <!-- SECTION: LET'S BE REAL                             -->
    <!-- ═══════════════════════════════════════════════════ -->
    <section>
      <div class="container">
        <h2>Let's Be Real</h2>
        <p>Most people's MacBooks live on a desk, plugged in, slowly wearing out the battery that makes it portable. The laptop replaced the desktop &mdash; but Apple didn't update the battery to act like a PSU. <strong>So BetterBattery does.</strong><span id="lbr-more-link"> <a href="#" id="lbr-toggle" style="color: var(--accent); white-space: nowrap;">... more</a></span><span id="lbr-expanded" style="display: none;"><br><br>Apple built <a href="https://support.apple.com/en-us/102589" target="_blank" rel="noopener">Optimized Battery Charging</a> and can even <a href="https://support.apple.com/en-us/102338" target="_blank" rel="noopener">detect when your MacBook is &ldquo;rarely used on battery&rdquo;</a> &mdash; but it doesn't go far enough. It only holds at 80%, you can't customize the limit, and there's no way to toggle between desk and mobile modes. Meanwhile, Microsoft, Lenovo, Dell, and HP all independently shipped their own charge limiters &mdash; because <a href="https://growthmarketreports.com/report/laptop-docking-station-market" target="_blank" rel="noopener">over two-thirds of workplaces deploy docking stations</a> as standard hardware. Everyone knows laptops live on desks. BetterBattery just does something about it. <a href="#setup" style="color: var(--accent); font-weight: 600;">Set it up in 10 minutes &rarr;</a></span></p>
      </div>
    </section>


    <!-- ═══════════════════════════════════════════════════ -->
    <!-- SECTION 3: THE SCIENCE                             -->
    <!-- ═══════════════════════════════════════════════════ -->
    <section>
      <div class="container">
        <h2>The Science</h2>

        <ul class="science-list">
          <li><strong>High voltage degrades batteries.</strong> Keeping a lithium-ion cell above 80% charge puts constant stress on the cathode, accelerating chemical breakdown. Lower charge = lower voltage = less stress.</li>
          <li><strong>Every laptop maker knows this.</strong> Apple, Lenovo, Dell, and ASUS all ship some form of charge limiting. The science is settled &mdash; it's just not turned on by default.</li>
          <li><strong>The numbers are significant.</strong> Batteries held at 70&ndash;80% retain roughly 96% of their capacity after one year. At 100%, that drops to around 80%. That's the difference between a 6-year battery and a 3-year one.</li>
        </ul>

        <details>
          <summary>Research citations</summary>
          <div class="details-body">
            <p><strong>Battery University BU-808</strong> &mdash; "How to Prolong Lithium-based Batteries." Comprehensive overview of voltage stress, depth of discharge, and temperature effects on cell longevity. <a href="https://batteryuniversity.com/article/bu-808-how-to-prolong-lithium-based-batteries" target="_blank" rel="noopener">Read article</a></p>
            <p><strong>Choi &amp; Lim (2002)</strong> &mdash; "Factors that affect cycle-life and possible degradation mechanisms of a Li-ion cell based on LiCoO2." Journal of Power Sources. Demonstrated that higher upper charge voltage significantly reduces cycle life.</p>
            <p><strong>Wikner &amp; Thiringer (2018)</strong> &mdash; "Extending Battery Lifetime by Avoiding High SOC." Applied Energy. Calendar aging study showing that state-of-charge is the dominant factor in capacity fade, even more than cycling.</p>
            <p><strong>Dahn Lab, Dalhousie University (2019&ndash;2022)</strong> &mdash; Multiple studies on long-term degradation of NMC and LFP cells. Confirmed that reducing upper charge voltage from 4.2V to 4.0V (roughly 100% to 70%) can more than double calendar life.</p>
            <p><strong>Apple Technical Support</strong> &mdash; Apple's own documentation acknowledges that "charging your battery to full and keeping it there for extended periods can be detrimental," which is why they introduced Optimized Battery Charging.</p>
          </div>
        </details>
      </div>
    </section>


    <!-- ═══════════════════════════════════════════════════ -->
    <!-- SECTION 4: ENVIRONMENTAL CASE                      -->
    <!-- ═══════════════════════════════════════════════════ -->
    <section class="environment" id="environment">
      <div class="container">
        <h2>The Bigger Picture</h2>
        <p class="env-intro">Every battery that lasts twice as long is one that never needs to be mined, manufactured, shipped, and disposed of. Here's what that adds up to.</p>

        <!-- Impact Calculator — lead with agency -->
        <div class="calculator">
          <h3>What if more people did this?</h3>
          <p class="calc-label">Move the slider to see the impact if a percentage of MacBook users adopted charge limiting:</p>

          <div class="calc-slider-row">
            <input type="range" id="adoption-slider" min="1" max="100" value="10" aria-label="Adoption percentage">
            <span class="calc-pct" id="adoption-value">10%</span>
          </div>

          <div class="calc-timeframe">
            <span class="calc-timeframe-label">Over</span>
            <button class="calc-time-pill selected" data-years="1">1 year</button>
            <button class="calc-time-pill" data-years="5">5 years</button>
            <button class="calc-time-pill" data-years="10">10 years</button>
          </div>

          <div class="calc-results">
            <div class="calc-result">
              <span class="calc-result-number" id="calc-replacements">1.1M</span>
              <span class="calc-result-label">battery replacements avoided <span id="calc-period">per year</span></span>
            </div>
            <div class="calc-result">
              <span class="calc-result-number" id="calc-co2">57,143</span>
              <span class="calc-result-label">tonnes CO&#8322; saved</span>
            </div>
            <div class="calc-result">
              <span class="calc-result-number" id="calc-lithium">8,000</span>
              <span class="calc-result-label">kg lithium kept in the ground</span>
            </div>
          </div>
          <p class="calc-footnote">Estimates based on published research from Battery University, Apple Environmental Reports, and MIT. <a href="#calc-methodology" id="calc-methodology-link">See the numbers behind this</a></p>
        </div>

        <p class="env-empowerment"><strong>You're not just saving your battery.</strong> You're part of something bigger.</p>

        <details id="calc-methodology">
          <summary>The numbers behind this</summary>
          <div class="details-body">
            <p><strong>6&ndash;8g of lithium</strong> in every MacBook battery &mdash; mined from fragile desert ecosystems in Chile, Argentina, and Australia. <a href="https://batteryguy.com/kb/knowledge-base/how-to-calculate-the-lithium-content-in-a-battery/" target="_blank" rel="noopener">IATA lithium content standard</a></p>
            <p><strong>70% of global cobalt</strong> comes from the DRC, often from artisanal mines with severe human and environmental costs. <a href="https://pubs.usgs.gov/periodicals/mcs2024/mcs2024-cobalt.pdf" target="_blank" rel="noopener">USGS Mineral Commodity Summary</a></p>
            <p><strong>~50kg of CO&#8322;</strong> emitted manufacturing and shipping each replacement battery (range: 30&ndash;60kg). <a href="https://climate.mit.edu/ask-mit/how-much-co2-emitted-manufacturing-batteries" target="_blank" rel="noopener">MIT Climate Portal</a>, <a href="https://www.apple.com/environment/" target="_blank" rel="noopener">Apple Environmental Reports</a></p>
            <p><strong>62 million tonnes</strong> of e-waste generated globally in 2022 &mdash; the fastest-growing waste stream on the planet. Only 22% is properly recycled. <a href="https://ewastemonitor.info/" target="_blank" rel="noopener">Global E-waste Monitor 2024</a></p>
            <p><strong>Battery chemicals leach.</strong> Lithium, cobalt, nickel, and manganese from improperly disposed batteries contaminate soil and groundwater. <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10683946/" target="_blank" rel="noopener">PMC &mdash; Supply chain environmental impacts</a></p>
            <p style="margin-top: 14px; font-size: 0.88rem;"><strong>Calculator methodology:</strong> Based on ~80M active MacBooks (<a href="https://www.spyhunter.com/shm/macos-stats/" target="_blank" rel="noopener">analyst estimates</a>; ~86% of ~100M Macs). Assumes each adopter avoids one battery replacement per 7 years (<a href="https://support.apple.com/en-us/102888" target="_blank" rel="noopener">Apple rates batteries at 1,000 cycles</a>). CO&#8322; at 50kg and lithium at 7g per replacement. Battery longevity data from <a href="https://batteryuniversity.com/article/bu-808-how-to-prolong-lithium-based-batteries" target="_blank" rel="noopener">Battery University BU-808</a>.</p>
          </div>
        </details>

      </div>
    </section>


    <!-- ═══════════════════════════════════════════════════ -->
    <!-- SECTION 5: SETUP — INTERACTIVE TRIAGE               -->
    <!-- ═══════════════════════════════════════════════════ -->
    <section class="setup" id="setup">
      <div class="container-wide">
        <h2>Set It Up</h2>
        <p>Two ways to get started. Both take about 10 minutes and work on any Apple Silicon Mac (M1&ndash;M4).</p>

        <div class="setup-triage">

          <!-- ── STEP 1: Choose Setup Method ── -->
          <div class="triage-step" id="triage-step-1">
            <div class="triage-cards">

              <!-- Card A: Claude -->
              <div class="triage-card recommended" data-step="1" data-value="claude">

                <!-- Intro (visible before selection) -->
                <div class="triage-card-intro">
                  <span class="triage-card-badge">Recommended</span>
                  <div class="triage-card-title">Let Claude set it up</div>
                  <p class="triage-card-desc">Claude is an AI assistant that walks you through each step &mdash; or runs the commands for you automatically. The free version works for this. No technical knowledge needed.</p>
                  <button class="triage-card-cta" data-step="1" data-value="claude">Get started with Claude</button>
                </div>

                <!-- Flow (replaces intro after selection) -->
                <div class="triage-card-flow hidden">
                  <div class="triage-card-flow-header">
                    <div class="triage-card-title">Let Claude set it up</div>
                    <button class="triage-card-change">Change</button>
                  </div>

                  <!-- Stepper -->
                  <div class="triage-stepper">
                    <div class="triage-stepper-step active" data-substep="1"><span>1</span></div>
                    <div class="triage-stepper-line"></div>
                    <div class="triage-stepper-step" data-substep="2"><span>2</span></div>
                  </div>

                  <!-- Substep 1: Device check -->
                  <div class="triage-substep" id="claude-substep-1">
                    <div class="triage-question">What kind of Mac do you have?</div>
                    <div class="triage-options">
                      <button class="triage-pill" data-substep="1" data-value="apple-silicon">Apple Silicon (M1&ndash;M4)</button>
                      <button class="triage-pill" data-substep="1" data-value="intel">Intel</button>
                      <button class="triage-pill" data-substep="1" data-value="not-sure">Not sure</button>
                      <button class="triage-pill" data-substep="1" data-value="not-mac">I don't have a Mac</button>
                    </div>

                    <div class="triage-result hidden" id="result-intel">
                      <div class="triage-stop">
                        <p><strong>batt requires Apple Silicon.</strong> For Intel Macs, try <a href="https://apphousekitchen.com/" target="_blank" rel="noopener">AlDente</a> &mdash; it does the same thing. The battery science in this guide still applies.</p>
                      </div>
                    </div>

                    <div class="triage-result hidden" id="result-not-sure">
                      <div class="triage-help">
                        <p>Click <strong>&#xF8FF;</strong> (Apple menu) &rarr; <strong>About This Mac</strong>. If you see <strong>M1, M2, M3, or M4</strong> under "Chip," you're good. If you see "Processor" with an Intel name, you have an Intel Mac.</p>
                        <div class="triage-options">
                          <button class="triage-pill" data-substep="1" data-value="apple-silicon">It says M1/M2/M3/M4</button>
                          <button class="triage-pill" data-substep="1" data-value="intel">It says Intel</button>
                        </div>
                      </div>
                    </div>

                    <div class="triage-result hidden" id="result-not-mac">
                      <div class="triage-stop info">
                        <p><strong>This guide is for MacBooks</strong>, but the science works for any laptop. Most manufacturers have charge-limiting built in &mdash; check your battery settings or companion app (Lenovo Vantage, Dell Power Manager, ASUS MyASUS, HP Command Center). <a href="#faq-windows">More details in FAQ &darr;</a></p>
                      </div>
                    </div>
                  </div>

                  <!-- Substep 2: Claude type -->
                  <div class="triage-substep hidden" id="claude-substep-2">
                    <div class="triage-question">How do you use Claude?</div>
                    <div class="triage-options">
                      <button class="triage-pill" data-substep="2" data-value="claude-code">Claude Code</button>
                      <button class="triage-pill" data-substep="2" data-value="claude-desktop">Claude desktop app</button>
                      <button class="triage-pill" data-substep="2" data-value="claude-browser">Claude in the browser</button>
                      <button class="triage-pill" data-substep="2" data-value="whats-claude">What's Claude?</button>
                    </div>

                    <div class="triage-result hidden" id="result-claude-code">
                      <p class="prompt-intro">Copy this prompt and paste it into <strong>Claude Code</strong>. It will run each command directly in your terminal.</p>

                      <div class="code-block">
                        <pre><code>I want to set up the BetterBattery method on my MacBook to limit charging and extend my battery life. You have direct access to my terminal &mdash; run each command yourself and explain what you're doing.

Here's the full setup guide (from betterbattery.org):

STEP 1 &mdash; INSTALL HOMEBREW (package manager for Mac)
- First check if it's already installed: brew --version
- If not found, install it: /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
- After install, run the PATH command Homebrew shows you, then close and reopen Terminal
- If already installed, skip to step 2

STEP 2 &mdash; INSTALL BATT (the battery tool)
- brew install batt
- sudo brew services start batt (needs my Mac login password &mdash; nothing shows when typing, that's normal)

STEP 3 &mdash; SET CHARGE LIMIT
- Ask me: 70% (best for longevity, Mac rarely leaves desk) or 80% (good balance, unplug sometimes)
- Run: batt limit &lt;my choice&gt;
- Verify: batt status &mdash; should show "Upper limit: XX%"

STEP 4 &mdash; DISABLE APPLE'S OPTIMIZED BATTERY CHARGING
- System Settings &rarr; Battery &rarr; Battery Health &rarr; (i) &rarr; toggle OFF "Optimized Battery Charging"
- This conflicts with batt and can override the limit if left on

STEP 5 &mdash; CREATE TOGGLE SCRIPT
- Create ~/bin/toggle-battery-limit.sh that checks the current batt limit and toggles between my desk limit and 100% (mobile mode), with macOS notifications via osascript

STEP 6 &mdash; CREATE AUTO-DRAIN MONITOR
- Create ~/bin/batt-monitor.sh &mdash; checks every 60 seconds if battery is above my limit, disables the power adapter to drain, re-enables when at/below lower limit. Skips if in mobile mode (limit is 100%).
- Create a launchd agent at ~/Library/LaunchAgents/com.betterbattery.monitor.plist with StartInterval 60 and RunAtLoad true, pointing to the monitor script

STEP 7 &mdash; CREATE MACOS SHORTCUT
- Open Shortcuts app &rarr; Menu Bar section &rarr; new shortcut &rarr; "Run Shell Script" action &rarr; set shell to zsh &rarr; enter path to toggle script &rarr; rename to "Toggle Battery Limit"

STEP 8 &mdash; SET UP KEYBOARD SHORTCUT (&#x21E7;&#x2318;B)
- Create an Automator Quick Action (.workflow) in ~/Library/Services/ that runs the toggle script
- Register &#x21E7;&#x2318;B as the keyboard shortcut via `defaults write pbs NSServicesStatus`
- Check which of Chrome, Arc, and VS Code are installed &mdash; if any use &#x21E7;&#x2318;B, remap their shortcut to &#x2303;&#x21E7;&#x2318;B (Control+Shift+Command+B) and tell me what you changed
- Refresh the services cache with /System/Library/CoreServices/pbs -update
- Tell me if I need to log out and back in for the shortcut to activate

STEP 9 &mdash; VERIFY &amp; EXPLAIN
- Run batt status (check limit is set)
- Run launchctl list | grep betterbattery (confirm monitor is running)
- Test the keyboard shortcut &#x21E7;&#x2318;B and confirm it toggles
- Tell me what to expect day-to-day: MagSafe LED colors, battery percentage cycling, what happens during shutdowns

Run each step, verify it worked, and move on. If anything fails, troubleshoot before continuing.</code></pre>
                        <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                      </div>

                      <p class="prompt-note">Claude Code will run the commands directly in your terminal and explain each step as it goes.</p>
                    </div>

                    <div class="triage-result hidden" id="result-claude-desktop">
                      <p class="prompt-intro">The Claude Mac app can either <strong>run commands for you</strong> (hands-free) or <strong>walk you through it</strong> step by step. Which do you prefer?</p>
                      <div class="triage-options">
                        <button class="triage-pill" data-desktop-mode="hands-free">Run commands for me</button>
                        <button class="triage-pill" data-desktop-mode="guided">Walk me through it</button>
                      </div>

                      <!-- Desktop: hands-free (Desktop Commander) -->
                      <div class="triage-result hidden" id="result-desktop-handsfree">
                        <div class="callout" style="margin-bottom: 16px;">
                          <p><strong>One-time setup:</strong> To let Claude run commands, you need to install <a href="https://desktopcommander.app/" target="_blank" rel="noopener">Desktop Commander</a> &mdash; a free, open-source extension (5,500+ GitHub stars) that gives Claude access to your terminal. You only need to do this once.</p>
                        </div>
                        <p style="font-size: 0.95rem; margin-bottom: 12px;"><strong>Step 1:</strong> Open the <strong>Terminal</strong> app (<code>Cmd + Space</code>, type &ldquo;Terminal&rdquo;).</p>
                        <p style="font-size: 0.95rem; margin-bottom: 6px;"><strong>Step 2:</strong> Paste this and press Enter:</p>
                        <div class="code-block">
                          <pre><code>curl -fsSL https://raw.githubusercontent.com/wonderwhy-er/DesktopCommanderMCP/refs/heads/main/install.sh | bash</code></pre>
                          <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                        </div>
                        <p style="font-size: 0.95rem; margin-bottom: 16px;"><strong>Step 3:</strong> Quit and reopen the Claude app.</p>
                        <p class="prompt-intro">Now copy this prompt into the Claude Mac app. Claude will run each command for you:</p>
                        <div class="code-block">
                          <pre><code>I want to set up the BetterBattery method on my MacBook to limit charging and extend my battery life. You have access to my terminal through Desktop Commander &mdash; run each command yourself and explain what you're doing.

Here's the full setup guide (from betterbattery.org):

STEP 1 &mdash; INSTALL HOMEBREW (package manager for Mac)
- First check if it's already installed: brew --version
- If not found, install it: /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
- After install, run the PATH command Homebrew shows you, then close and reopen Terminal
- If already installed, skip to step 2

STEP 2 &mdash; INSTALL BATT (the battery tool)
- brew install batt
- sudo brew services start batt (needs my Mac login password &mdash; nothing shows when typing, that's normal)

STEP 3 &mdash; SET CHARGE LIMIT
- Ask me: 70% (best for longevity, Mac rarely leaves desk) or 80% (good balance, unplug sometimes)
- Run: batt limit &lt;my choice&gt;
- Verify: batt status &mdash; should show "Upper limit: XX%"

STEP 4 &mdash; DISABLE APPLE'S OPTIMIZED BATTERY CHARGING
- System Settings &rarr; Battery &rarr; Battery Health &rarr; (i) &rarr; toggle OFF "Optimized Battery Charging"
- This conflicts with batt and can override the limit if left on

STEP 5 &mdash; CREATE TOGGLE SCRIPT
- Create ~/bin/toggle-battery-limit.sh that checks the current batt limit and toggles between my desk limit and 100% (mobile mode), with macOS notifications via osascript

STEP 6 &mdash; CREATE AUTO-DRAIN MONITOR
- Create ~/bin/batt-monitor.sh &mdash; checks every 60 seconds if battery is above my limit, disables the power adapter to drain, re-enables when at/below lower limit. Skips if in mobile mode (limit is 100%).
- Create a launchd agent at ~/Library/LaunchAgents/com.betterbattery.monitor.plist with StartInterval 60 and RunAtLoad true, pointing to the monitor script

STEP 7 &mdash; CREATE MACOS SHORTCUT
- Open Shortcuts app &rarr; Menu Bar section &rarr; new shortcut &rarr; "Run Shell Script" action &rarr; set shell to zsh &rarr; enter path to toggle script &rarr; rename to "Toggle Battery Limit"

STEP 8 &mdash; SET UP KEYBOARD SHORTCUT (&#x21E7;&#x2318;B)
- Create an Automator Quick Action (.workflow) in ~/Library/Services/ that runs the toggle script
- Register &#x21E7;&#x2318;B as the keyboard shortcut via `defaults write pbs NSServicesStatus`
- Check which of Chrome, Arc, and VS Code are installed &mdash; if any use &#x21E7;&#x2318;B, remap their shortcut to &#x2303;&#x21E7;&#x2318;B (Control+Shift+Command+B) and tell me what you changed
- Refresh the services cache with /System/Library/CoreServices/pbs -update
- Tell me if I need to log out and back in for the shortcut to activate

STEP 9 &mdash; VERIFY &amp; EXPLAIN
- Run batt status (check limit is set)
- Run launchctl list | grep betterbattery (confirm monitor is running)
- Test the keyboard shortcut &#x21E7;&#x2318;B and confirm it toggles
- Tell me what to expect day-to-day: MagSafe LED colors, battery percentage cycling, what happens during shutdowns

Run each step, verify it worked, and move on. If anything fails, troubleshoot before continuing.</code></pre>
                          <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                        </div>
                        <p class="prompt-note">Claude will run the commands and explain each step as it goes. You may see approval prompts for certain actions &mdash; just click Allow.</p>
                      </div>

                      <!-- Desktop: guided walkthrough -->
                      <div class="triage-result hidden" id="result-desktop-guided">
                        <p class="prompt-intro">Copy this prompt and paste it into the <strong>Claude Mac app</strong>. Claude will walk you through the entire setup.</p>
                        <div class="code-block">
                          <pre><code>I want to set up the BetterBattery method on my MacBook to limit charging and extend my battery life. Walk me through everything step by step. I'm not technical &mdash; tell me exactly what to do, and wait for me to confirm each step before moving on.

Here's the full setup guide (from betterbattery.org):

STEP 1 &mdash; INSTALL HOMEBREW (package manager for Mac)
- First check if it's already installed: brew --version
- If not found, install it: /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
- After install, run the PATH command Homebrew shows you, then close and reopen Terminal
- If already installed, skip to step 2

STEP 2 &mdash; INSTALL BATT (the battery tool)
- brew install batt
- sudo brew services start batt (needs my Mac login password &mdash; nothing shows when typing, that's normal)

STEP 3 &mdash; SET CHARGE LIMIT
- Ask me: 70% (best for longevity, Mac rarely leaves desk) or 80% (good balance, unplug sometimes)
- Run: batt limit &lt;my choice&gt;
- Verify: batt status &mdash; should show "Upper limit: XX%"

STEP 4 &mdash; DISABLE APPLE'S OPTIMIZED BATTERY CHARGING
- System Settings &rarr; Battery &rarr; Battery Health &rarr; (i) &rarr; toggle OFF "Optimized Battery Charging"
- This conflicts with batt and can override the limit if left on

STEP 5 &mdash; CREATE TOGGLE SCRIPT
- Create ~/bin/toggle-battery-limit.sh that checks the current batt limit and toggles between my desk limit and 100% (mobile mode), with macOS notifications via osascript

STEP 6 &mdash; CREATE AUTO-DRAIN MONITOR
- Create ~/bin/batt-monitor.sh &mdash; checks every 60 seconds if battery is above my limit, disables the power adapter to drain, re-enables when at/below lower limit. Skips if in mobile mode (limit is 100%).
- Create a launchd agent at ~/Library/LaunchAgents/com.betterbattery.monitor.plist with StartInterval 60 and RunAtLoad true, pointing to the monitor script

STEP 7 &mdash; CREATE MACOS SHORTCUT
- Open Shortcuts app &rarr; Menu Bar section &rarr; new shortcut &rarr; "Run Shell Script" action &rarr; set shell to zsh &rarr; enter path to toggle script &rarr; rename to "Toggle Battery Limit"

STEP 8 &mdash; SET UP KEYBOARD SHORTCUT (&#x21E7;&#x2318;B)
- Walk me through creating an Automator Quick Action that runs the toggle script, then assigning Shift+Command+B as the keyboard shortcut in System Settings &rarr; Keyboard &rarr; Keyboard Shortcuts &rarr; Services
- Also tell me if any apps I use (Chrome, Arc, VS Code) already use that shortcut and what to do about it

STEP 9 &mdash; VERIFY &amp; EXPLAIN
- Run batt status (check limit is set)
- Run launchctl list | grep betterbattery (confirm monitor is running)
- Test the keyboard shortcut &#x21E7;&#x2318;B and confirm it toggles
- Tell me what to expect day-to-day: MagSafe LED colors, battery percentage cycling, what happens during shutdowns

If anything goes wrong at any step, help me troubleshoot before moving on.</code></pre>
                          <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                        </div>
                        <p class="prompt-note">Claude will tell you when to open Terminal and exactly what to type. Just follow along step by step.</p>
                      </div>
                    </div>

                    <div class="triage-result hidden" id="result-claude-browser">
                      <p class="prompt-intro">Copy this prompt and paste it into Claude at <a href="https://claude.ai" target="_blank" rel="noopener">claude.ai</a> (free). Claude will walk you through the entire setup.</p>

                      <div class="code-block">
                        <pre><code>I want to set up the BetterBattery method on my MacBook to limit charging and extend my battery life. Walk me through everything step by step. I'm not technical &mdash; tell me exactly what to do, and wait for me to confirm each step before moving on.

Here's the full setup guide (from betterbattery.org):

STEP 1 &mdash; INSTALL HOMEBREW (package manager for Mac)
- First check if it's already installed: brew --version
- If not found, install it: /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
- After install, run the PATH command Homebrew shows you, then close and reopen Terminal
- If already installed, skip to step 2

STEP 2 &mdash; INSTALL BATT (the battery tool)
- brew install batt
- sudo brew services start batt (needs my Mac login password &mdash; nothing shows when typing, that's normal)

STEP 3 &mdash; SET CHARGE LIMIT
- Ask me: 70% (best for longevity, Mac rarely leaves desk) or 80% (good balance, unplug sometimes)
- Run: batt limit &lt;my choice&gt;
- Verify: batt status &mdash; should show "Upper limit: XX%"

STEP 4 &mdash; DISABLE APPLE'S OPTIMIZED BATTERY CHARGING
- System Settings &rarr; Battery &rarr; Battery Health &rarr; (i) &rarr; toggle OFF "Optimized Battery Charging"
- This conflicts with batt and can override the limit if left on

STEP 5 &mdash; CREATE TOGGLE SCRIPT
- Create ~/bin/toggle-battery-limit.sh that checks the current batt limit and toggles between my desk limit and 100% (mobile mode), with macOS notifications via osascript

STEP 6 &mdash; CREATE AUTO-DRAIN MONITOR
- Create ~/bin/batt-monitor.sh &mdash; checks every 60 seconds if battery is above my limit, disables the power adapter to drain, re-enables when at/below lower limit. Skips if in mobile mode (limit is 100%).
- Create a launchd agent at ~/Library/LaunchAgents/com.betterbattery.monitor.plist with StartInterval 60 and RunAtLoad true, pointing to the monitor script

STEP 7 &mdash; CREATE MACOS SHORTCUT
- Open Shortcuts app &rarr; Menu Bar section &rarr; new shortcut &rarr; "Run Shell Script" action &rarr; set shell to zsh &rarr; enter path to toggle script &rarr; rename to "Toggle Battery Limit"

STEP 8 &mdash; SET UP KEYBOARD SHORTCUT (&#x21E7;&#x2318;B)
- Walk me through creating an Automator Quick Action that runs the toggle script, then assigning Shift+Command+B as the keyboard shortcut in System Settings &rarr; Keyboard &rarr; Keyboard Shortcuts &rarr; Services
- Also tell me if any apps I use (Chrome, Arc, VS Code) already use that shortcut and what to do about it

STEP 9 &mdash; VERIFY &amp; EXPLAIN
- Run batt status (check limit is set)
- Run launchctl list | grep betterbattery (confirm monitor is running)
- Test the keyboard shortcut &#x21E7;&#x2318;B and confirm it toggles
- Tell me what to expect day-to-day: MagSafe LED colors, battery percentage cycling, what happens during shutdowns

If anything goes wrong at any step, help me troubleshoot before moving on.</code></pre>
                        <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                      </div>

                      <p class="prompt-note">Claude will tell you when to open Terminal and exactly what to type. Just follow along step by step.</p>
                    </div>

                    <div class="triage-result hidden" id="result-whats-claude">
                      <div class="claude-explainer">
                        <p><strong>Claude</strong> is an AI assistant made by <a href="https://www.anthropic.com" target="_blank" rel="noopener">Anthropic</a>. You can use the free version at <a href="https://claude.ai" target="_blank" rel="noopener">claude.ai</a> &mdash; it can walk you through technical setup step by step, answer your questions, and troubleshoot problems. No subscription needed for this.</p>
                        <p>It's like having a patient tech friend on call.</p>
                        <a href="https://claude.ai" target="_blank" rel="noopener" class="cta-link">Sign up at claude.ai (free) &rarr;</a>
                        <br>
                        <a href="#" class="cta-link" id="skip-to-diy" style="color: var(--text-muted); font-size: 0.9rem;">Or skip Claude and do it yourself &darr;</a>
                      </div>
                    </div>
                  </div>

                </div>
              </div>

              <!-- Card B: DIY -->
              <div class="triage-card" data-step="1" data-value="diy">
                <div class="triage-card-intro">
                  <div class="triage-card-title">I'll do it myself</div>
                  <p class="triage-card-desc">Follow step-by-step terminal commands at your own pace. You'll need to be comfortable copying and pasting into Terminal.</p>
                  <button class="triage-card-cta" data-step="1" data-value="diy">Show me the steps</button>
                </div>
                <div class="triage-card-flow hidden">
                  <div class="triage-card-flow-header">
                    <div class="triage-card-title">I'll do it myself</div>
                    <button class="triage-card-change">Change</button>
                  </div>
                </div>
              </div>

            </div>

            <!-- App Teaser -->
            <div class="app-teaser">
              <div class="app-teaser-title">BetterBattery app &mdash; coming soon</div>
              <p class="app-teaser-desc">Skip the terminal. One-click battery management, built right into a Mac app.</p>
              <div class="app-teaser-actions">
                <button class="app-teaser-plus" id="app-plus-btn">
                  <span>&#x1F44D;</span>
                  <span>I'd use this</span>
                  <span class="app-teaser-plus-count" id="app-plus-count"></span>
                </button>
                <form class="app-teaser-form" id="app-teaser-form">
                  <input type="email" placeholder="you@email.com" required aria-label="Email for app updates">
                  <button type="submit">Notify me</button>
                </form>
                <span class="app-teaser-thanks" id="app-teaser-thanks">Thanks! We'll let you know.</span>
              </div>
            </div>

            <!-- Result: DIY accordion (outside the cards, below them) -->
            <div class="triage-result hidden" id="result-diy">

              <div class="callout" style="margin-bottom: 20px;">
                <p><strong>Requires Apple Silicon (M1&ndash;M4).</strong> Intel Mac? Try <a href="https://apphousekitchen.com/" target="_blank" rel="noopener">AlDente</a> instead.</p>
              </div>

              <!-- DIY Step 1 -->
              <div class="diy-step">
                <details>
                  <summary>1. Install Homebrew</summary>
                  <div class="details-body">
                    <p>Check if it's already installed:</p>
                    <div class="code-block">
                      <pre><code>brew --version</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>If you see a version number, skip to step 2. If you see "command not found," install it:</p>
                    <div class="code-block">
                      <pre><code>/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <div class="callout">
                      <p><strong>After it finishes:</strong> Homebrew will display lines telling you to run commands to add it to your PATH. Follow those instructions, then <strong>close and reopen Terminal</strong> before continuing.</p>
                    </div>
                  </div>
                </details>
              </div>

              <!-- DIY Step 2 -->
              <div class="diy-step">
                <details>
                  <summary>2. Install batt</summary>
                  <div class="details-body">
                    <p><a href="https://github.com/charlie0129/batt" target="_blank" rel="noopener">batt</a> is a free, open-source tool that controls your MacBook's charging. No ads, no telemetry, runs locally.</p>
                    <div class="code-block">
                      <pre><code>brew install batt</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>Start the background service:</p>
                    <div class="code-block">
                      <pre><code>sudo brew services start batt</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <div class="callout">
                      <p><strong>Password prompt:</strong> Type your Mac login password. Nothing appears as you type &mdash; that's normal. Press Enter.</p>
                    </div>
                  </div>
                </details>
              </div>

              <!-- DIY Step 3 -->
              <div class="diy-step">
                <details>
                  <summary>3. Set your charge limit</summary>
                  <div class="details-body">
                    <p><strong>70%</strong> &mdash; Best for longevity. Great if your Mac rarely leaves the desk.<br>
                    <strong>80%</strong> &mdash; Good balance if you unplug a few times a week.</p>
                    <p>For 70%:</p>
                    <div class="code-block">
                      <pre><code>batt limit 70</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>Or for 80%:</p>
                    <div class="code-block">
                      <pre><code>batt limit 80</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>Verify it's working:</p>
                    <div class="code-block">
                      <pre><code>batt status</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>You should see <code>Upper limit: 70%</code> (or 80%) in the output.</p>
                  </div>
                </details>
              </div>

              <!-- DIY Step 4 -->
              <div class="diy-step">
                <details>
                  <summary>4. Disable Apple's battery management</summary>
                  <div class="details-body">
                    <p>Apple's built-in battery feature conflicts with batt. Turn it off:</p>
                    <div class="nav-path">
                      System Settings <span>&rarr;</span> Battery <span>&rarr;</span> Battery Health <span>&rarr;</span> <strong>(i)</strong> <span>&rarr;</span> toggle <strong>OFF</strong> "Optimized Battery Charging"
                    </div>
                    <div class="callout warning">
                      <p><strong>Don't skip this.</strong> If left on, Apple's feature may override your limit and charge to 100% unpredictably.</p>
                    </div>
                  </div>
                </details>
              </div>

              <!-- DIY Step 5 -->
              <div class="diy-step">
                <details>
                  <summary>5. Create the toggle script</summary>
                  <div class="details-body">
                    <p>This script flips between your desk limit and 100% (mobile mode). For <strong>70%</strong>:</p>
                    <div class="code-block">
                      <pre><code>mkdir -p ~/bin &amp;&amp; cat > ~/bin/toggle-battery-limit.sh &lt;&lt; 'SCRIPT'
#!/bin/zsh
CURRENT=$(/opt/homebrew/bin/batt status 2>&amp;1)
if echo "$CURRENT" | grep -q "Upper limit: 70%"; then
    /opt/homebrew/bin/batt limit 100 2>&amp;1
    osascript -e 'display notification "Charging to 100% — Mobile Mode" with title "Battery"'
else
    /opt/homebrew/bin/batt limit 70 2>&amp;1
    osascript -e 'display notification "Capped at 70% — Desk Mode" with title "Battery"'
fi
SCRIPT
chmod +x ~/bin/toggle-battery-limit.sh</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>For <strong>80%</strong>, use this version instead:</p>
                    <div class="code-block">
                      <pre><code>mkdir -p ~/bin &amp;&amp; cat > ~/bin/toggle-battery-limit.sh &lt;&lt; 'SCRIPT'
#!/bin/zsh
CURRENT=$(/opt/homebrew/bin/batt status 2>&amp;1)
if echo "$CURRENT" | grep -q "Upper limit: 80%"; then
    /opt/homebrew/bin/batt limit 100 2>&amp;1
    osascript -e 'display notification "Charging to 100% — Mobile Mode" with title "Battery"'
else
    /opt/homebrew/bin/batt limit 80 2>&amp;1
    osascript -e 'display notification "Capped at 80% — Desk Mode" with title "Battery"'
fi
SCRIPT
chmod +x ~/bin/toggle-battery-limit.sh</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>No output means it worked.</p>
                  </div>
                </details>
              </div>

              <!-- DIY Step 6 -->
              <div class="diy-step">
                <details>
                  <summary>6. Install the auto-drain monitor</summary>
                  <div class="details-body">
                    <p>This script runs in the background and automatically drains your battery when it's above your limit &mdash; for example, after a shutdown charges it to 100%. Without this, you'd have to wait for natural drain.</p>
                    <p>Create the monitor script:</p>
                    <div class="code-block">
                      <pre><code>cat > ~/bin/batt-monitor.sh &lt;&lt; 'SCRIPT'
#!/bin/zsh
# batt-monitor.sh — Auto-drain battery to target limit
BATT="/opt/homebrew/bin/batt"
LOG_TAG="batt-monitor"

STATUS=$($BATT status 2>&amp;1)
UPPER=$(echo "$STATUS" | grep "Upper limit:" | grep -oE '[0-9]+')
LOWER=$(echo "$STATUS" | grep "Lower limit:" | grep -oE '[0-9]+')

# Mobile mode (100%) — make sure adapter is on, exit
if [ "$UPPER" = "100" ]; then
    ADAPTER_DISABLED=$(echo "$STATUS" | grep "Use power adapter" | grep -c "✘")
    if [ "$ADAPTER_DISABLED" -eq 1 ]; then
        $BATT adapter enable >/dev/null 2>&amp;1
        logger -t "$LOG_TAG" "Mobile mode — re-enabled adapter"
    fi
    exit 0
fi

CHARGE=$(echo "$STATUS" | grep "Current charge:" | grep -oE '[0-9]+')

if [ -z "$UPPER" ] || [ -z "$LOWER" ] || [ -z "$CHARGE" ]; then
    logger -t "$LOG_TAG" "Could not read batt status — skipping"
    exit 0
fi

ADAPTER_DISABLED=$(echo "$STATUS" | grep "Use power adapter" | grep -c "✘")

if [ "$ADAPTER_DISABLED" -eq 1 ]; then
    if [ "$CHARGE" -le "$LOWER" ]; then
        $BATT adapter enable >/dev/null 2>&amp;1
        logger -t "$LOG_TAG" "Reached ${CHARGE}% (lower ${LOWER}%) — re-enabled adapter"
    fi
elif [ "$CHARGE" -gt "$UPPER" ]; then
    $BATT adapter disable >/dev/null 2>&amp;1
    logger -t "$LOG_TAG" "At ${CHARGE}% (above ${UPPER}%) — disabled adapter to drain"
fi
SCRIPT
chmod +x ~/bin/batt-monitor.sh</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>Now create a background agent that runs it every 60 seconds:</p>
                    <div class="code-block">
                      <pre><code>cat > ~/Library/LaunchAgents/com.betterbattery.monitor.plist &lt;&lt; PLIST
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
    &lt;key&gt;Label&lt;/key&gt;
    &lt;string&gt;com.betterbattery.monitor&lt;/string&gt;
    &lt;key&gt;ProgramArguments&lt;/key&gt;
    &lt;array&gt;
        &lt;string&gt;/bin/zsh&lt;/string&gt;
        &lt;string&gt;/Users/$(whoami)/bin/batt-monitor.sh&lt;/string&gt;
    &lt;/array&gt;
    &lt;key&gt;StartInterval&lt;/key&gt;
    &lt;integer&gt;60&lt;/integer&gt;
    &lt;key&gt;RunAtLoad&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;StandardErrorPath&lt;/key&gt;
    &lt;string&gt;/tmp/batt-monitor.err&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
PLIST</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>Load it:</p>
                    <div class="code-block">
                      <pre><code>launchctl load ~/Library/LaunchAgents/com.betterbattery.monitor.plist</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>Verify it's running:</p>
                    <div class="code-block">
                      <pre><code>launchctl list | grep betterbattery</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>You should see a line with <code>com.betterbattery.monitor</code>. The monitor will now keep your battery at your target automatically.</p>
                  </div>
                </details>
              </div>

              <!-- DIY Step 7 -->
              <div class="diy-step">
                <details>
                  <summary>7. Create a macOS Shortcut</summary>
                  <div class="details-body">
                    <p>First, find your username:</p>
                    <div class="code-block">
                      <pre><code>whoami</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>Open the <strong>Shortcuts</strong> app (<code>Cmd + Space</code>, type "Shortcuts") and:</p>
                    <ol style="margin: 12px 0 12px 24px; line-height: 2.2; font-size: 0.92rem;">
                      <li>Click <strong>"Menu Bar"</strong> in the left sidebar</li>
                      <li>Click <strong>+</strong> to create a new shortcut</li>
                      <li>Search for <strong>"Run Shell Script"</strong> and add it</li>
                      <li>Set Shell to <strong>zsh</strong></li>
                      <li>Enter: <code>/Users/USERNAME/bin/toggle-battery-limit.sh</code><br>(replace USERNAME with your <code>whoami</code> result)</li>
                      <li>Leave <strong>"Run as Administrator"</strong> unchecked</li>
                      <li>Rename to <strong>"Toggle Battery Limit"</strong></li>
                    </ol>
                    <p>You'll now see it in your menu bar under the Shortcuts icon.</p>
                  </div>
                </details>
              </div>

              <!-- DIY Step 8 -->
              <div class="diy-step">
                <details>
                  <summary>8. Add a keyboard shortcut (optional)</summary>
                  <div class="details-body">
                    <p>Add a system-wide &#x21E7;&#x2318;B (Shift+Command+B) shortcut so you can toggle without touching the mouse.</p>
                    <p>Create the Automator Quick Action:</p>
                    <div class="code-block">
                      <pre><code>mkdir -p ~/Library/Services/Toggle\ Battery\ Limit.workflow/Contents &amp;&amp; cat > ~/Library/Services/Toggle\ Battery\ Limit.workflow/Contents/Info.plist &lt;&lt; 'INFOPLIST'
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
    &lt;key&gt;NSServices&lt;/key&gt;
    &lt;array&gt;
        &lt;dict&gt;
            &lt;key&gt;NSMenuItem&lt;/key&gt;
            &lt;dict&gt;
                &lt;key&gt;default&lt;/key&gt;
                &lt;string&gt;Toggle Battery Limit&lt;/string&gt;
            &lt;/dict&gt;
            &lt;key&gt;NSMessage&lt;/key&gt;
            &lt;string&gt;runWorkflowAsService&lt;/string&gt;
            &lt;key&gt;NSRequiredContext&lt;/key&gt;
            &lt;dict/&gt;
        &lt;/dict&gt;
    &lt;/array&gt;
&lt;/dict&gt;
&lt;/plist&gt;
INFOPLIST</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <div class="code-block">
                      <pre><code>cat > ~/Library/Services/Toggle\ Battery\ Limit.workflow/Contents/document.wflow &lt;&lt; WFLOW
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
    &lt;key&gt;AMApplicationBuild&lt;/key&gt;
    &lt;string&gt;523&lt;/string&gt;
    &lt;key&gt;AMApplicationVersion&lt;/key&gt;
    &lt;string&gt;2.10&lt;/string&gt;
    &lt;key&gt;actions&lt;/key&gt;
    &lt;array&gt;
        &lt;dict&gt;
            &lt;key&gt;action&lt;/key&gt;
            &lt;dict&gt;
                &lt;key&gt;AMAccepts&lt;/key&gt;
                &lt;dict&gt;
                    &lt;key&gt;Container&lt;/key&gt;
                    &lt;string&gt;List&lt;/string&gt;
                    &lt;key&gt;Optional&lt;/key&gt;
                    &lt;true/&gt;
                    &lt;key&gt;Types&lt;/key&gt;
                    &lt;array&gt;
                        &lt;string&gt;com.apple.cocoa.string&lt;/string&gt;
                    &lt;/array&gt;
                &lt;/dict&gt;
                &lt;key&gt;AMActionVersion&lt;/key&gt;
                &lt;string&gt;2.0.3&lt;/string&gt;
                &lt;key&gt;AMApplication&lt;/key&gt;
                &lt;array&gt;
                    &lt;string&gt;Automator&lt;/string&gt;
                &lt;/array&gt;
                &lt;key&gt;AMBundleIdentifier&lt;/key&gt;
                &lt;string&gt;com.apple.RunShellScript&lt;/string&gt;
                &lt;key&gt;AMCategory&lt;/key&gt;
                &lt;array&gt;
                    &lt;string&gt;AMCategoryUtilities&lt;/string&gt;
                &lt;/array&gt;
                &lt;key&gt;AMIconName&lt;/key&gt;
                &lt;string&gt;Automator&lt;/string&gt;
                &lt;key&gt;AMName&lt;/key&gt;
                &lt;string&gt;Run Shell Script&lt;/string&gt;
                &lt;key&gt;AMProvides&lt;/key&gt;
                &lt;dict&gt;
                    &lt;key&gt;Container&lt;/key&gt;
                    &lt;string&gt;List&lt;/string&gt;
                    &lt;key&gt;Types&lt;/key&gt;
                    &lt;array&gt;
                        &lt;string&gt;com.apple.cocoa.string&lt;/string&gt;
                    &lt;/array&gt;
                &lt;/dict&gt;
                &lt;key&gt;ActionBundlePath&lt;/key&gt;
                &lt;string&gt;/System/Library/Automator/Run Shell Script.action&lt;/string&gt;
                &lt;key&gt;ActionName&lt;/key&gt;
                &lt;string&gt;Run Shell Script&lt;/string&gt;
                &lt;key&gt;ActionParameters&lt;/key&gt;
                &lt;dict&gt;
                    &lt;key&gt;COMMAND_STRING&lt;/key&gt;
                    &lt;string&gt;/Users/\$(whoami)/bin/toggle-battery-limit.sh&lt;/string&gt;
                    &lt;key&gt;CheckedForUserDefaultShell&lt;/key&gt;
                    &lt;true/&gt;
                    &lt;key&gt;inputMethod&lt;/key&gt;
                    &lt;integer&gt;0&lt;/integer&gt;
                    &lt;key&gt;shell&lt;/key&gt;
                    &lt;string&gt;/bin/zsh&lt;/string&gt;
                    &lt;key&gt;source&lt;/key&gt;
                    &lt;string&gt;&lt;/string&gt;
                &lt;/dict&gt;
                &lt;key&gt;BundleIdentifier&lt;/key&gt;
                &lt;string&gt;com.apple.RunShellScript&lt;/string&gt;
                &lt;key&gt;CFBundleVersion&lt;/key&gt;
                &lt;string&gt;2.0.3&lt;/string&gt;
            &lt;/dict&gt;
        &lt;/dict&gt;
    &lt;/array&gt;
    &lt;key&gt;connectors&lt;/key&gt;
    &lt;dict/&gt;
    &lt;key&gt;workflowMetaData&lt;/key&gt;
    &lt;dict&gt;
        &lt;key&gt;workflowTypeIdentifier&lt;/key&gt;
        &lt;string&gt;com.apple.Automator.servicesMenu&lt;/string&gt;
    &lt;/dict&gt;
&lt;/dict&gt;
&lt;/plist&gt;
WFLOW</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>Refresh the services cache and register the shortcut:</p>
                    <div class="code-block">
                      <pre><code>/System/Library/CoreServices/pbs -update</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <div class="code-block">
                      <pre><code>defaults write pbs NSServicesStatus -dict-add '"(null) - Toggle Battery Limit - runWorkflowAsService"' '{ "key_equivalent" = "@$b"; }'</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <div class="callout">
                      <p><strong>App conflicts:</strong> Chrome and Arc use &#x21E7;&#x2318;B for "Always Show Bookmarks Bar," and VS Code uses it for "Run Build Task." If you use these apps and want to remap their shortcut to &#x2303;&#x21E7;&#x2318;B (Control+Shift+Command+B):</p>
                    </div>
                    <div class="code-block">
                      <pre><code># Chrome (skip if you don't use Chrome)
defaults write com.google.Chrome NSUserKeyEquivalents -dict-add "Always Show Bookmarks Bar" "^@\$b"

# Arc (skip if you don't use Arc)
defaults write company.thebrowser.Browser NSUserKeyEquivalents -dict-add "Always Show Bookmarks Bar" "^@\$b"</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <p>For VS Code, open <code>~/Library/Application Support/Code/User/keybindings.json</code> and add:</p>
                    <div class="code-block">
                      <pre><code>[
    { "key": "ctrl+shift+cmd+b", "command": "workbench.action.tasks.build" },
    { "key": "shift+cmd+b", "command": "-workbench.action.tasks.build" }
]</code></pre>
                      <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
                    </div>
                    <div class="callout">
                      <p><strong>Note:</strong> You may need to <strong>log out and back in</strong> for macOS to activate the keyboard shortcut.</p>
                    </div>
                  </div>
                </details>
              </div>

              <!-- DIY Step 9 -->
              <div class="diy-step">
                <details>
                  <summary>9. Add to Control Center (optional)</summary>
                  <div class="details-body">
                    <ol style="margin: 12px 0 12px 24px; line-height: 2.2; font-size: 0.92rem;">
                      <li>Open <strong>Control Center</strong> (click the icon in your menu bar)</li>
                      <li>Click the <strong>+</strong> at the bottom left</li>
                      <li>Find and add <strong>Shortcuts</strong></li>
                      <li>Select <strong>"Toggle Battery Limit"</strong></li>
                    </ol>
                    <p>Now you can toggle with one tap from Control Center.</p>
                  </div>
                </details>
              </div>

            </div>
          </div>

        </div>
      </div>
    </section>


    <!-- ═══════════════════════════════════════════════════ -->
    <!-- SECTION 6: WHAT TO EXPECT                          -->
    <!-- ═══════════════════════════════════════════════════ -->
    <section>
      <div class="container">
        <h2>What to Expect</h2>
        <p>After setup, here's what you'll notice day-to-day:</p>

        <ul class="expect-list" style="margin-top: 64px;">
          <li>
            <span class="expect-icon">&#x26A1;</span>
            <div class="expect-text">
              <strong>The lightning bolt stays.</strong>
              The battery icon in your menu bar will still show a lightning bolt (&#x26A1;) when plugged in. That means "connected to power," not "currently charging." This is normal.
            </div>
          </li>
          <li>
            <span class="expect-icon">&#x1F7E2;</span>
            <div class="expect-text">
              <strong>MagSafe LED colors.</strong>
              Green means your battery is at the limit and holding. Amber means it's actively charging (either toward your limit or toward 100% in mobile mode).
            </div>
          </li>
          <li>
            <span class="expect-icon">&#x1F504;</span>
            <div class="expect-text">
              <strong>Small cycling is normal.</strong>
              Your battery might drift between 68% and 70% (or 78% and 80%). This tiny range is normal and healthy &mdash; batt lets it fluctuate slightly to avoid constant micro-charging.
            </div>
          </li>
          <li>
            <span class="expect-icon">&#x1F4C9;</span>
            <div class="expect-text">
              <strong>Battery above limit will auto-drain.</strong>
              If your Mac charges to 100% during a shutdown, the auto-drain monitor will notice and gently drain it back to your limit by disabling the power adapter temporarily. You might see the percentage dropping — that's the monitor doing its job.
            </div>
          </li>
          <li>
            <span class="expect-icon">&#x1F50C;</span>
            <div class="expect-text">
              <strong>Shutdowns charge to 100%.</strong>
              When your Mac is fully shut down, batt isn't running, so the hardware charges normally. This is a hardware limitation &mdash; it's fine for occasional shutdowns. The monitor will drain it back when your Mac wakes up.
            </div>
          </li>
        </ul>
      </div>
    </section>


    <!-- ═══════════════════════════════════════════════════ -->
    <!-- SECTION 7: FAQ / TROUBLESHOOTING                   -->
    <!-- ═══════════════════════════════════════════════════ -->
    <section class="faq">
      <div class="container">
        <h2>Frequently Asked Questions</h2>

        <details>
          <summary>Will this void my warranty?</summary>
          <div class="details-body">
            <p>No. You're not modifying hardware or bypassing security protections. batt communicates with the SMC (System Management Controller) the same way Apple's own tools do. You can uninstall everything in under a minute.</p>
          </div>
        </details>

        <details>
          <summary>Is batt safe?</summary>
          <div class="details-body">
            <p>Yes. It's open source with over 1,500 stars on GitHub, meaning its code is public and auditable. It collects no data, has no telemetry, requires no internet connection, and runs entirely on your Mac. <a href="https://github.com/charlie0129/batt" target="_blank" rel="noopener">View on GitHub</a></p>
          </div>
        </details>

        <details>
          <summary>Should I pick 70% or 80%?</summary>
          <div class="details-body">
            <p><strong>70%</strong> is better for long-term battery health. <strong>80%</strong> gives you more charge when you unplug. Both are significantly better than 100%. If your Mac rarely leaves your desk, go with 70%. If you unplug a few times a week, 80% gives you more buffer.</p>
          </div>
        </details>

        <details>
          <summary>What about Apple's built-in charge limit?</summary>
          <div class="details-body">
            <p>Recent versions of macOS (Sonoma 14.4 and later) include a built-in 80% charge limit option. It works, but batt gives you more control: any percentage you want, a toggle script for desk/mobile mode, and the auto-drain monitor that actively manages your battery. If you prefer Apple's native option, it's a fine choice too &mdash; 80% is far better than 100%.</p>
          </div>
        </details>

        <details>
          <summary>Does this work on Intel Macs?</summary>
          <div class="details-body">
            <p>No. batt only works on Apple Silicon Macs (M1, M2, M3, M4). If you have an Intel Mac, look into <a href="https://apphousekitchen.com/" target="_blank" rel="noopener">AlDente</a>, which supports both Intel and Apple Silicon.</p>
          </div>
        </details>

        <details id="faq-windows">
          <summary>Does this work on Windows or Linux?</summary>
          <div class="details-body">
            <p>No &mdash; batt and this guide are for Apple Silicon Macs only. For Windows laptops, check your manufacturer's battery management software (Lenovo Vantage, Dell Power Manager, ASUS MyASUS, HP Command Center). Many Windows laptops have built-in charge limiting in their BIOS or companion apps. The same science applies &mdash; keeping any laptop battery at 70&ndash;80% extends its life regardless of platform.</p>
          </div>
        </details>

        <details>
          <summary>Can I change the limit later?</summary>
          <div class="details-body">
            <p>Anytime. Run <code>batt limit XX</code> with your new number. If you made a toggle script, also update the percentage inside it.</p>
          </div>
        </details>

        <details>
          <summary>What about sleep or closing the lid?</summary>
          <div class="details-body">
            <p>Handled. batt disables charging before sleep to prevent your Mac from quietly charging to 100% overnight. When it wakes, the limit is re-applied automatically.</p>
          </div>
        </details>

        <details>
          <summary>Something isn't working &mdash; how do I troubleshoot?</summary>
          <div class="details-body">
            <p>Go to <a href="https://claude.ai" target="_blank" rel="noopener">claude.ai</a> and tell it: "I followed the BetterBattery guide at betterbattery.org and [describe what's wrong]. Help me fix it." Claude can run diagnostics, check your configuration, and walk you through fixes.</p>
          </div>
        </details>

        <details>
          <summary>How do I uninstall everything?</summary>
          <div class="details-body">
            <p>These commands remove everything:</p>
            <div class="code-block">
              <pre><code>sudo brew services stop batt
brew uninstall batt
rm ~/bin/toggle-battery-limit.sh
rm ~/bin/batt-monitor.sh
launchctl unload ~/Library/LaunchAgents/com.betterbattery.monitor.plist
rm ~/Library/LaunchAgents/com.betterbattery.monitor.plist
rm -rf ~/Library/Services/Toggle\ Battery\ Limit.workflow</code></pre>
              <button class="copy-btn" aria-label="Copy to clipboard">Copy</button>
            </div>
            <p>Then go to System Settings &rarr; Battery &rarr; Battery Health and turn <strong>Optimized Battery Charging</strong> back on. Delete the Shortcut you created in the Shortcuts app. If you remapped keyboard shortcuts for Chrome, Arc, or VS Code, revert those changes.</p>
          </div>
        </details>

        <details>
          <summary>Keep batt updated</summary>
          <div class="details-body">
            <p>batt is actively maintained. To update, run <code>brew upgrade batt</code> in Terminal occasionally. Updates add new macOS compatibility and bug fixes.</p>
          </div>
        </details>
      </div>
    </section>

    <!-- ═══════════════════════════════════════════════════ -->
    <!-- CLOSING IMPACT                                     -->
    <!-- ═══════════════════════════════════════════════════ -->
    <section class="closing">
      <div class="container">
        <h2>Your MacBook battery is dying<br>while it sits on your desk.</h2>
        <p class="subtitle">Over 100 million Macs sit plugged in right now, batteries held at 100% &mdash; slowly degrading. Every worn-out battery means more lithium mining, more manufacturing emissions, and more e-waste. A simple change can double your battery's lifespan.</p>

        <div class="stats-grid">
          <div class="stat">
            <span class="stat-number">2&times;</span>
            <span class="stat-label">Longer battery life at 70&ndash;80% charge</span>
          </div>
          <div class="stat">
            <span class="stat-number">$199+</span>
            <span class="stat-label">Apple battery replacement cost</span>
          </div>
          <div class="stat">
            <span class="stat-number">80M+</span>
            <span class="stat-label">MacBooks that could benefit</span>
          </div>
          <div class="stat">
            <span class="stat-number">78%</span>
            <span class="stat-label">Of e-waste never gets recycled</span>
          </div>
        </div>

        <a href="#setup" class="cta-btn">Set it up now &rarr;</a>
      </div>
    </section>

  </main>


  <!-- ═══════════════════════════════════════════════════ -->
  <!-- FOOTER                                             -->
  <!-- ═══════════════════════════════════════════════════ -->
  <footer>
    <div class="container">
      <p>Built on <a href="https://github.com/charlie0129/batt">batt</a> by charlie0129. Open source, GPL-2.0.</p>
      <p>BetterBattery.org is a free community resource. Not affiliated with Apple.</p>
      <p style="margin-top: 8px; font-size: 0.8rem;">Environmental data: Global E-waste Monitor 2024, Battery University, USGS Mineral Commodity Summaries.</p>
    </div>
  </footer>


  <!-- ═══════════════════════════════════════════════════ -->
  <!-- JAVASCRIPT                                         -->
  <!-- ═══════════════════════════════════════════════════ -->
  <script>
    // ── Copy to clipboard ──
    document.querySelectorAll('.copy-btn').forEach(function(btn) {
      btn.addEventListener('click', function() {
        var code = btn.closest('.code-block').querySelector('code').textContent;
        navigator.clipboard.writeText(code).then(function() {
          btn.textContent = 'Copied!';
          btn.classList.add('copied');
          setTimeout(function() {
            btn.textContent = 'Copy';
            btn.classList.remove('copied');
          }, 2000);
        });
      });
    });

    // ── Setup triage flow ──
    var triageCards = document.querySelector('#triage-step-1 .triage-cards');
    var claudeCard = document.querySelector('.triage-card[data-value="claude"]');

    function showResult(id) {
      var el = document.getElementById(id);
      if (el) {
        el.classList.remove('hidden');
        el.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }
    }

    // ── Card selection (Step 1) ──
    function selectStep1(value) {
      document.querySelectorAll('#triage-step-1 .triage-card').forEach(function(c) {
        c.classList.remove('selected');
      });
      var card = document.querySelector('#triage-step-1 .triage-card[data-value="' + value + '"]');
      if (card) card.classList.add('selected');
      triageCards.classList.add('chosen');

      // Hide DIY result
      document.getElementById('result-diy').classList.add('hidden');

      if (value === 'claude') {
        // Reset substeps inside the Claude card
        resetClaudeFlow();
      } else if (value === 'diy') {
        showResult('result-diy');
      }
    }

    function resetStep1() {
      triageCards.classList.remove('chosen');
      document.querySelectorAll('#triage-step-1 .triage-card').forEach(function(c) {
        c.classList.remove('selected');
      });
      document.getElementById('result-diy').classList.add('hidden');
      resetClaudeFlow();
    }

    // Click card or CTA to select (only when not yet chosen)
    document.querySelectorAll('#triage-step-1 .triage-card').forEach(function(card) {
      card.addEventListener('click', function(e) {
        if (e.target.classList.contains('triage-card-change')) return;
        if (triageCards.classList.contains('chosen')) return;
        selectStep1(card.getAttribute('data-value'));
      });
    });

    // "Change" buttons reset to two-card view
    document.querySelectorAll('.triage-card-change').forEach(function(btn) {
      btn.addEventListener('click', function(e) {
        e.stopPropagation();
        resetStep1();
      });
    });

    // ── Claude card substeps ──
    var stepperSteps = claudeCard.querySelectorAll('.triage-stepper-step');
    var stepperLine = claudeCard.querySelector('.triage-stepper-line');
    var substep1 = document.getElementById('claude-substep-1');
    var substep2 = document.getElementById('claude-substep-2');

    function updateStepper(activeStep) {
      stepperSteps.forEach(function(s) {
        var n = parseInt(s.getAttribute('data-substep'));
        s.classList.remove('active', 'done');
        if (n < activeStep) s.classList.add('done');
        else if (n === activeStep) s.classList.add('active');
      });
      if (activeStep > 1) stepperLine.classList.add('done');
      else stepperLine.classList.remove('done');
    }

    function resetClaudeFlow() {
      // Reset substep 1
      substep1.classList.remove('hidden');
      substep1.querySelectorAll('.triage-pill').forEach(function(p) { p.classList.remove('selected'); });
      substep1.querySelectorAll('.triage-result').forEach(function(r) { r.classList.add('hidden'); });
      // Reset substep 2
      substep2.classList.add('hidden');
      substep2.querySelectorAll('.triage-pill').forEach(function(p) { p.classList.remove('selected'); });
      substep2.querySelectorAll('.triage-result').forEach(function(r) { r.classList.add('hidden'); });
      // Reset stepper
      updateStepper(1);
    }

    // Substep 1: Device check pills
    document.querySelectorAll('[data-substep="1"]').forEach(function(pill) {
      pill.addEventListener('click', function() {
        var value = pill.getAttribute('data-value');

        // Deselect all substep 1 pills (including sub-pills in "Not sure")
        substep1.querySelectorAll('.triage-pill').forEach(function(p) { p.classList.remove('selected'); });
        pill.classList.add('selected');

        // Hide all substep 1 results
        substep1.querySelectorAll('.triage-result').forEach(function(r) { r.classList.add('hidden'); });
        // Reset substep 2
        substep2.classList.add('hidden');
        substep2.querySelectorAll('.triage-pill').forEach(function(p) { p.classList.remove('selected'); });
        substep2.querySelectorAll('.triage-result').forEach(function(r) { r.classList.add('hidden'); });
        updateStepper(1);

        if (value === 'apple-silicon') {
          updateStepper(2);
          substep2.classList.remove('hidden');
          substep2.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        } else if (value === 'intel') {
          showResult('result-intel');
        } else if (value === 'not-sure') {
          showResult('result-not-sure');
        } else if (value === 'not-mac') {
          showResult('result-not-mac');
        }
      });
    });

    // Substep 2: Claude type pills
    document.querySelectorAll('[data-substep="2"]').forEach(function(pill) {
      pill.addEventListener('click', function() {
        var value = pill.getAttribute('data-value');

        substep2.querySelectorAll('.triage-pill').forEach(function(p) { p.classList.remove('selected'); });
        pill.classList.add('selected');
        substep2.querySelectorAll('.triage-result').forEach(function(r) { r.classList.add('hidden'); });
        // Reset desktop sub-choice
        document.querySelectorAll('[data-desktop-mode]').forEach(function(p) { p.classList.remove('selected'); });
        document.getElementById('result-desktop-handsfree').classList.add('hidden');
        document.getElementById('result-desktop-guided').classList.add('hidden');

        if (value === 'claude-code') {
          showResult('result-claude-code');
        } else if (value === 'claude-desktop') {
          showResult('result-claude-desktop');
        } else if (value === 'claude-browser') {
          showResult('result-claude-browser');
        } else if (value === 'whats-claude') {
          showResult('result-whats-claude');
        }
      });
    });

    // Desktop app mode pills (hands-free vs guided)
    document.querySelectorAll('[data-desktop-mode]').forEach(function(pill) {
      pill.addEventListener('click', function() {
        var mode = pill.getAttribute('data-desktop-mode');
        var parent = document.getElementById('result-claude-desktop');
        parent.querySelectorAll('[data-desktop-mode]').forEach(function(p) { p.classList.remove('selected'); });
        pill.classList.add('selected');
        document.getElementById('result-desktop-handsfree').classList.add('hidden');
        document.getElementById('result-desktop-guided').classList.add('hidden');
        if (mode === 'hands-free') {
          showResult('result-desktop-handsfree');
        } else if (mode === 'guided') {
          showResult('result-desktop-guided');
        }
      });
    });

    // "Skip to DIY" link
    var skipLink = document.getElementById('skip-to-diy');
    if (skipLink) {
      skipLink.addEventListener('click', function(e) {
        e.preventDefault();
        selectStep1('diy');
      });
    }

    // ── Impact calculator ──
    var slider = document.getElementById('adoption-slider');
    var pctLabel = document.getElementById('adoption-value');
    var calcReplacements = document.getElementById('calc-replacements');
    var calcCo2 = document.getElementById('calc-co2');
    var calcLithium = document.getElementById('calc-lithium');
    var calcPeriod = document.getElementById('calc-period');
    var selectedYears = 1;

    function formatNumber(n) {
      if (n >= 1000000) return (n / 1000000).toFixed(1).replace(/\.0$/, '') + 'M';
      return n.toLocaleString();
    }

    function updateCalculator() {
      var pct = parseInt(slider.value);
      var rate = pct / 100;
      var macbooks = 80000000;

      // Each adopter avoids ~1 battery replacement per 7 years
      var replacements = Math.round(rate * macbooks / 7 * selectedYears);
      // ~50kg CO2 per replacement, convert to tonnes
      var co2 = Math.round(replacements * 50 / 1000);
      // ~7g lithium per battery, convert to kg
      var lithium = Math.round(replacements * 7 / 1000);

      pctLabel.textContent = pct + '%';
      calcReplacements.textContent = formatNumber(replacements);
      calcCo2.textContent = formatNumber(co2);
      calcLithium.textContent = formatNumber(lithium);
      calcPeriod.textContent = selectedYears === 1 ? 'per year' : 'over ' + selectedYears + ' years';
    }

    slider.addEventListener('input', updateCalculator);

    document.querySelectorAll('.calc-time-pill').forEach(function(pill) {
      pill.addEventListener('click', function() {
        document.querySelectorAll('.calc-time-pill').forEach(function(p) { p.classList.remove('selected'); });
        pill.classList.add('selected');
        selectedYears = parseInt(pill.getAttribute('data-years'));
        updateCalculator();
      });
    });

    updateCalculator();

    // ── Logo scrolls to top ──
    document.getElementById('logo-link').addEventListener('click', function(e) {
      e.preventDefault();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // ── "Let's Be Real" progressive disclosure ──
    document.getElementById('lbr-toggle').addEventListener('click', function(e) {
      e.preventDefault();
      document.getElementById('lbr-more-link').style.display = 'none';
      document.getElementById('lbr-expanded').style.display = 'inline';
    });

    // ── Methodology link opens accordion ──
    document.getElementById('calc-methodology-link').addEventListener('click', function(e) {
      e.preventDefault();
      var details = document.getElementById('calc-methodology');
      details.open = true;
      var section = details.closest('section');
      section.scrollIntoView({ behavior: 'smooth', block: 'end' });
    });

    // ── Header: normal at top, sticky reveal-on-scroll-up after passing it ──
    var headerWrap = document.getElementById('header-wrap');
    var headerSpacer = document.getElementById('header-spacer');
    var headerHeight = headerWrap.offsetHeight;
    var lastScrollY = window.scrollY;
    headerSpacer.style.height = headerHeight + 'px';

    window.addEventListener('scroll', function() {
      var currentY = window.scrollY;

      if (currentY <= headerHeight) {
        // Still in the header zone — keep it in normal document flow
        headerWrap.classList.remove('header-sticky', 'header-visible');
      } else {
        // Past the header — enable sticky behavior
        if (!headerWrap.classList.contains('header-sticky')) {
          headerWrap.style.transition = 'none';
          headerWrap.classList.add('header-sticky');
          headerWrap.offsetHeight; // force reflow — snap to hidden, no animation
          headerWrap.style.transition = '';
        }
        if (currentY < lastScrollY) {
          headerWrap.classList.add('header-visible');
        } else {
          headerWrap.classList.remove('header-visible');
        }
      }

      lastScrollY = currentY;
    }, { passive: true });

    // ── App teaser: +1 and email signup ──
    var plusBtn = document.getElementById('app-plus-btn');
    var plusCount = document.getElementById('app-plus-count');
    var appForm = document.getElementById('app-teaser-form');
    var appThanks = document.getElementById('app-teaser-thanks');

    // +1 button — localStorage for visual feedback
    var voted = localStorage.getItem('bb-app-voted');
    var count = parseInt(localStorage.getItem('bb-app-count') || '0', 10);
    if (voted) {
      plusBtn.classList.add('voted');
      plusCount.textContent = '+' + count;
    }

    plusBtn.addEventListener('click', function() {
      if (voted) return;
      voted = true;
      count++;
      localStorage.setItem('bb-app-voted', '1');
      localStorage.setItem('bb-app-count', String(count));
      plusBtn.classList.add('voted');
      plusCount.textContent = '+' + count;
    });

    // Email form — stores locally for now (swap action to Formspree/Buttondown later)
    var emailSubmitted = localStorage.getItem('bb-app-email');
    if (emailSubmitted) {
      appForm.style.display = 'none';
      appThanks.style.display = 'inline';
    }

    appForm.addEventListener('submit', function(e) {
      e.preventDefault();
      var email = appForm.querySelector('input[type="email"]').value;
      // TODO: Send to Formspree, Buttondown, or similar — for now, store locally
      localStorage.setItem('bb-app-email', email);
      appForm.style.display = 'none';
      appThanks.style.display = 'inline';
    });
  </script>

</body>
</html>
